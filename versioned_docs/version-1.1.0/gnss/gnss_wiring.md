---
id: gnss_wiring
title: Підключення плати GNSS sanity board
sidebar_label: Підключення (wiring)
---

Ця сторінка показує, як фізично підключити плату **GNSS sanity board на STM32F401** до GNSS-приймача та автопілота ArduPilot.

![Схема підключення GNSS → плата → автопілот](https://i.imgur.com/DQ7K5Fp.png)

---

## 1. Мінімальна схема підключення

Типовий ланцюжок:

~~~text
GNSS-приймач → UART → GNSS sanity board → UART (MAVLink) → автопілот
~~~

Потрібно підключити:

1. **Живлення** (5 В + GND).
2. **UART GNSS → плата** (TX GNSS → RX плати).
3. **UART плата → автопілот** (TX плати → RX FC).
4. (Опціонально) **UART автопілот → плата** (TX FC → RX плати) для прийому heartbeat/параметрів.
5. (Опціонально) **USB** для дебагу.

---

## 2. Живлення

### 2.1. Підключення від автопілота

Найпростіший варіант — живити плату від 5 V рейки автопілота (TELEM/GPS розʼєм або AUX 5 V).

| FC     | Плата GNSS sanity board |
|--------|-------------------------|
| 5V     | 5V / VIN                |
| GND    | GND                     |

Рекомендації:

- не живити плату від “шумного” BEC, який живить серви без фільтрації;
- якщо ж таки так — бажано LC-фільтр або хоча б окремий BEC для бортової електроніки.

### 2.2. Підключення від окремого BEC

Якщо живлення окреме:

- зʼєднай **GND** плати з **GND** автопілота;
- 5 В на плату подавай вже з окремого BEC.

---

## 3. Підключення GNSS-приймача до плати

### 3.1. Піни плати (сторона GNSS)

- `GPS_RX` (A3) — RX MCU (сюди йде TX GNSS).
- `GPS_TX` (A2) — TX MCU (до RX GNSS, якщо потрібна конфігурація).
- `GND` — спільна земля.

### 3.2. Типове підключення

| GNSS-приймач | Плата GNSS sanity board |
|--------------|-------------------------|
| TX           | GPS_RX (A3)            |
| RX           | GPS_TX (A2) *(опц.)*   |
| GND          | GND                     |
| 5V / VCC     | 5V / VIN (або той самий BEC, що й плата/FC) |

ASCII-схема:

~~~text
[GNSS module]
   TX  ---------------->  GPS_RX (A3)
   RX  <---------------- GPS_TX (A2)   (опціонально)
   GND ----------------- GND
   VCC ----------------- 5V / VIN
~~~


---

## 4. Підключення плати до автопілота (MAVLink)

### 4.1. Піни плати (сторона FC)

- `FC_TX` (A9) — TX MCU → RX FC.
- `FC_RX` (A10) — RX MCU ← TX FC (опціонально).
- `5V` — живлення (якщо від FC).
- `GND` — земля.

### 4.2. Типове підключення до порту SERIALx

| Автопілот (порт SERIALx / TELEMx) | Плата GNSS sanity board |
|-----------------------------------|-------------------------|
| TX (SERIALx_TX)                   | FC_RX (A10) *(опц.)*   |
| RX (SERIALx_RX)                   | FC_TX (A9)             |
| 5V                                | 5V / VIN *(опц.)*       |
| GND                               | GND                     |

ASCII-схема:

~~~text
[GNSS sanity board]                 [Flight Controller]

FC_TX (A9) --------------------->  SERIALx_RX
FC_RX (A10) <--------------------- SERIALx_TX   (опціонально)
5V         <----------------------  5V (якщо живлення від FC)
GND        <----------------------  GND
~~~

**Мінімум, без зворотнього каналу:**

~~~text
FC_TX (A9)  -->  SERIALx_RX
GND          <--> GND
~~~

---

## 5. Підключення USB для дебагу

Для отримання логів (режим DR, кількість супутників, координати):

- підключи USB до компʼютера;
- відкрий серійну консоль (наприклад 115200 бод);
- дивись строки типу:

~~~text
fix=3 s=18 hd=0.9 sp=0.0 crs=0.0 alt=176.3 DR0
~~~

USB ніяк не впливає на роботу з FC — це чисто debug.

---

## 6. Приклади повних схем

### 6.1. Приклад A: F10N + Pixhawk 6X (SERIAL2 / TELEM2)

**Склад:**

- GNSS F10N з виходом UART.
- Плата GNSS sanity board.
- Pixhawk 6X (або інший автопілот з ArduPilot).

**Зʼєднання:**

1. **Живлення:**

   | Хто       | Куди                   |
   |-----------|------------------------|
   | 5V BEC    | FC 5V + плата 5V/VIN   |
   | GND BEC   | FC GND + плата GND + GNSS GND |

2. **GNSS → плата:**

   | GNSS | Плата |
   |------|-------|
   | TX   | GPS_RX (A3) |
   | RX   | GPS_TX (A2) *(опц.)* |
   | GND  | GND |

3. **Плата → FC (SERIAL2 / TELEM2):**

   | FC TELEM2 | Плата |
   |-----------|-------|
   | RX        | FC_TX (A9)  |
   | TX        | FC_RX (A10) *(опц.)* |
   | 5V        | 5V / VIN |
   | GND       | GND |


Після такого підключення:

- У Mission Planner: налаштувати `SERIAL2_PROTOCOL = 2`, `SERIAL2_BAUD = 115` і `GPS_TYPE = 14`.
- Плата шле GPS по MAVLink в SERIAL2.

---

### 6.2. Приклад B: F9P + CUAV X7 (PORT: GPS2 як “сырой” F9P, TELEM2 — GNSS sanity board)

Сценарій:  

- `GPS1` — напряму F9P до FC (як основний GPS);
- `GPS2` — GNSS sanity board, який виступає як "sanity GPS" по MAVLink (додатковий).

**Схема:**

1. **F9P → GPS1 (CUAV X7)** — стандартне підключення (без нашої плати).
2. **Той самий F9P UART2 → GNSS sanity board**:
   - TX UART2 F9P → GPS_RX (A3);
   - GND спільний.
3. **GNSS sanity board → TELEM2 (SERIAL2)**:
   - FC_TX (A9) → SERIAL2_RX;
   - за бажанням SERIAL2_TX → FC_RX (A10);
   - GND спільний, 5V — від FC або BEC.

---

## 7. Перевірка перед першим запуском

Перед тим, як подавати живлення:

1. **Перевір полярність живлення.**
   - 5V → 5V/VIN;  
   - GND → GND.
2. **Перевір, що TX/RX не переплутані:**
   - TX GNSS → `GPS_RX`;
   - `FC_TX (A9)` → RX FC (SERIALx_RX).
3. **Перевір, що земля спільна для GNSS, плати і автопілота.**
4. **Перевір відсутність “кілець” живлення:**
   - не підводь 5 В з двох різних BEC одночасно без ізоляції.

Після цього:

- подай живлення;
- поглянь на LED (чи блимає як в нормальному режимі);
- підключи USB та перевір, що в логах є правдоподібні координати і `DR0`;
- налаштуй FC (`SERIALx_PROTOCOL`, `SERIALx_BAUD`, `GPS_TYPE = 14`) і перевір, що в Mission Planner зʼявляється GPS.

---

## 8. Типові помилки при wiringʼу

- **GNSS підключено напряму до GPS-порту FC**, а не через плату:
  - тоді автопілот бачить “чистий” GNSS, а плата ніяк не впливає.
- **Переплутані TX/RX**:
  - GNSS TX → GNSS RX плати (а не навпаки);
  - FC RX → FC_TX плати.
- **Немає спільної землі**:
  - плата отримує дані по UART “в повітрі” і все глючить.
- **5 В подані тільки на GNSS, а плата без живлення**:
  - GNSS працює, але плата не стартує, FC не бачить жодного GPS.

---

Цей розділ покриває фізичне підключення.  
У наступному розділі буде детальна **індикація станів та LED-патерни** (`gnss_led_status.md`), щоб можна було швидко дебажити wiring та режими DR прямо “на столі”.
