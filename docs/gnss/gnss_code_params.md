---
id: gnss_code_params
title: –†–µ—Ñ–µ—Ä–µ–Ω—Å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –ø—Ä–æ—à–∏–≤–∫–∏ STM32F401 GNSS sanity board
sidebar_label: –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—Ä–æ—à–∏–≤–∫–∏
description: –î–æ–≤—ñ–¥–Ω–∏–∫ –ø–æ –æ—Å–Ω–æ–≤–Ω–∏—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö, –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö —Ç–∞ –ª–æ–≥—ñ—Ü—ñ —Ä–æ–±–æ—Ç–∏ –ø—Ä–æ—à–∏–≤–∫–∏ –∞–Ω—Ç–∏-—Å–ø—É—Ñ—ñ–Ω–≥—É GNSS –Ω–∞ STM32F401 (–≤–µ—Ä—Å—ñ—è –∑ F10N / MAVLink GPS).
---

> ‚ö†Ô∏è **–ü—Ä–∏–º—ñ—Ç–∫–∞:** –Ω–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö/–∫–æ–Ω—Å—Ç–∞–Ω—Ç –Ω–∏–∂—á–µ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ –ø—ñ–¥ –≤–∞—à –ª—ñ—Ç–∞–ª—å–Ω–∏–π –∞–ø–ø–∞—Ä–∞—Ç –∑–∞ –∑–∞–ø–∏—Ç–æ–º.  

# 1. –û–≥–ª—è–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—à–∏–≤–∫–∏

–ü—Ä–æ—à–∏–≤–∫–∞ —É–º–æ–≤–Ω–æ –¥—ñ–ª–∏—Ç—å—Å—è –Ω–∞ –±–ª–æ–∫–∏:

1. **–°–∏—Å—Ç–µ–º–Ω—ñ IDs —Ç–∞ UART-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è** ‚Äî `MY_SYSID`, `FC_SYSID`, `FC_SERIAL`, `GNSS_SERIAL`, —à–≤–∏–¥–∫–æ—Å—Ç—ñ –ø–æ—Ä—Ç—ñ–≤.
2. **–ü–æ—Ä–æ–≥–∏ —è–∫–æ—Å—Ç—ñ GNSS** ‚Äî –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—É–ø—É—Ç–Ω–∏–∫—ñ–≤, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π HDOP —Ç–æ—â–æ.
3. **–¢—Ä–∏–≥–µ—Ä–∏ –∞–Ω—Ç–∏-—Å–ø—É—Ñ—ñ–Ω–≥—É** ‚Äî —Å—Ç—Ä–∏–±–æ–∫ –≤—ñ–¥—Å—Ç–∞–Ω—ñ, —à–≤–∏–¥–∫–æ—Å—Ç—ñ, –ø–µ—Ä–µ–ª—ñ—Ç —É –ü—ñ–≤–¥–µ–Ω–Ω—É –ø—ñ–≤–∫—É–ª—é.
4. **Dead Reckoning (DR)** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤—Ö–æ–¥—É/–≤–∏—Ö–æ–¥—É –∑ DR.
5. **MAVLink-–ø–æ–≤–µ–¥—ñ–Ω–∫–∞** ‚Äî —è–∫—ñ —Ç–∏–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —à–ª—é—Ç—å—Å—è, —è–∫ —Ñ–æ—Ä–º—É—î—Ç—å—Å—è `STATUSTEXT`.
6. **EEPROM / –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏** ‚Äî —è–∫—â–æ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤–∏–Ω–æ—Å–∏—Ç—å—Å—è –≤ EEPROM.

---

# 2. –°–∏—Å—Ç–µ–º–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ —Ç–∞ UART

## 2.1. MAVLink IDs

~~~cpp
static const uint8_t MY_SYSID  = 42;
static const uint8_t MY_COMPID = MAV_COMP_ID_ONBOARD_COMPUTER; // 191

static const uint8_t FC_SYSID  = 1;
static const uint8_t FC_COMPID = MAV_COMP_ID_AUTOPILOT1;       // 1
~~~

| –ü–∞—Ä–∞–º–µ—Ç—Ä    | –¢–∏–ø       | –ó–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º | –û–ø–∏—Å                                                     |
|-------------|-----------|---------------------------|----------------------------------------------------------|
| `MY_SYSID`  | `uint8_t` | `42`                      | `sysid` –ø–ª–∞—Ç–∏ –∞–Ω—Ç–∏-—Å–ø—É—Ñ—ñ–Ω–≥—É                              |
| `MY_COMPID` | `uint8_t` | `191`                     | `compid`, –∑–∞–∑–≤–∏—á–∞–π `MAV_COMP_ID_ONBOARD_COMPUTER`        |
| `FC_SYSID`  | `uint8_t` | `1`                       | `sysid` –∞–≤—Ç–æ–ø—ñ–ª–æ—Ç–∞ ArduPilot                             |
| `FC_COMPID` | `uint8_t` | `1`                       | `compid` –∞–≤—Ç–æ–ø—ñ–ª–æ—Ç–∞ (`MAV_COMP_ID_AUTOPILOT1`)           |

**–©–æ –º–æ–∂–Ω–∞ –º—ñ–Ω—è—Ç–∏**

- `MY_SYSID` ‚Äî –∑–º—ñ–Ω–∏—Ç–∏, —è–∫—â–æ –≤ —Å–∏—Å—Ç–µ–º—ñ –∫—ñ–ª—å–∫–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö MAVLink-–¥–µ–≤–∞–π—Å—ñ–≤.
- `MY_COMPID` ‚Äî –±–∞–∂–∞–Ω–æ –∑–∞–ª–∏—à–∏—Ç–∏, —â–æ–± —É –ª–æ–≥–∞—Ö –±—É–ª–æ –≤–∏–¥–Ω–æ ‚Äúonboard computer‚Äù.

---

## 2.2. UART-–ø–æ—Ä—Ç–∏

~~~cpp
#define FC_SERIAL   Serial1   // A9 TX -> FC RX,  A10 RX <- FC TX
#define GNSS_SERIAL Serial2   // A2 TX, A3 RX  (GNSS UART)
#define USB_SERIAL  Serial    // debug —á–µ—Ä–µ–∑ USB

static const uint32_t FC_BAUD   = 115200;
static const uint32_t GNSS_BAUD = 115200;
~~~

| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –¢–∏–ø        | –ó–Ω–∞—á–µ–Ω–Ω—è | –û–ø–∏—Å                                          |
|--------------|------------|----------|-----------------------------------------------|
| `FC_SERIAL`  | macro      | `Serial1`| UART –¥–æ –∞–≤—Ç–æ–ø—ñ–ª–æ—Ç–∞ (MAVLink)                 |
| `GNSS_SERIAL`| macro      | `Serial2`| UART –¥–æ F10N/F9P GNSS                        |
| `USB_SERIAL` | macro      | `Serial` | UART –¥–ª—è –ª–æ–≥—ñ–≤ –ø–æ USB                        |
| `FC_BAUD`    | `uint32_t` | `115200` | —à–≤–∏–¥–∫—ñ—Å—Ç—å MAVLink –¥–æ FC                      |
| `GNSS_BAUD`  | `uint32_t` | `115200` | —à–≤–∏–¥–∫—ñ—Å—Ç—å GNSS-UART (–º–∞—î –∑–±—ñ–≥–∞—Ç–∏—Å—è –∑ u-center)|

**–©–æ –º–æ–∂–Ω–∞ –º—ñ–Ω—è—Ç–∏**

- `FC_BAUD` ‚Äî –ø—ñ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π `SERIALx_BAUD` –≤ ArduPilot.
- `GNSS_BAUD` ‚Äî –ø—ñ–¥ —Ç–µ, —â–æ –≤–∏—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–ª—è F10N/F9P.

---

# 3. –ü–æ—Ä–æ–≥–∏ —è–∫–æ—Å—Ç—ñ GNSS

~~~cpp
static const uint8_t GNSS_MIN_SATS_FIX  = 4;    // –º—ñ–Ω—ñ–º—É–º –¥–ª—è 3D fix
static const uint8_t GNSS_MIN_SATS_GOOD = 8;    // "–∫–æ–º—Ñ–æ—Ä—Ç–Ω–∞" –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—É–ø—É—Ç–Ω–∏–∫—ñ–≤
static const float   GNSS_MAX_HDOP_GOOD = 2.5f; // –º–∞–∫—Å. HDOP –¥–ª—è —è–∫—ñ—Å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª—É
~~~

| –ü–∞—Ä–∞–º–µ—Ç—Ä              | –¢–∏–ø       | –î–µ—Ñ–æ–ª—Ç | –û–ø–∏—Å                                                  |
|-----------------------|-----------|--------|-------------------------------------------------------|
| `GNSS_MIN_SATS_FIX`   | `uint8_t` | `4`    | –ú—ñ–Ω—ñ–º—É–º —Å—É–ø—É—Ç–Ω–∏–∫—ñ–≤, —â–æ–± –≤–≤–∞–∂–∞—Ç–∏ fix –≤–∞–ª—ñ–¥–Ω–∏–º         |
| `GNSS_MIN_SATS_GOOD`  | `uint8_t` | `8`    | –í—ñ–¥ —Ü—ñ—î—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å–∏–≥–Ω–∞–ª –≤–≤–∞–∂–∞—î—Ç—å—Å—è ‚Äú—Ö–æ—Ä–æ—à–∏–º‚Äù       |
| `GNSS_MAX_HDOP_GOOD`  | `float`   | `2.5`  | –ú–∞–∫—Å. HDOP –¥–ª—è ‚Äú–Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ‚Äù —Ä–µ–∂–∏–º—É                  |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –£ –≤–∞–∂–∫–∏—Ö —É–º–æ–≤–∞—Ö (–º—ñ—Å—Ç–æ/—Ñ—Ä–æ–Ω—Ç) –º–æ–∂–Ω–∞ –ø—ñ–¥–Ω—è—Ç–∏ `GNSS_MAX_HDOP_GOOD` –¥–æ `3.0`.
- –î–ª—è –±—ñ–ª—å—à –∂–æ—Ä—Å—Ç–∫–æ–≥–æ —Ñ—ñ–ª—å—Ç—Ä—É –∑–±—ñ–ª—å—à–∏—Ç–∏ `GNSS_MIN_SATS_GOOD` –¥–æ `10‚Äì12`.

---

# 4. –¢—Ä–∏–≥–µ—Ä–∏ –∞–Ω—Ç–∏-—Å–ø—É—Ñ—ñ–Ω–≥—É

## 4.1. –°—Ç—Ä–∏–±–æ–∫ –≤—ñ–¥—Å—Ç–∞–Ω—ñ / —à–≤–∏–¥–∫–æ—Å—Ç—ñ

~~~cpp
static const float GNSS_MAX_DIST_JUMP_M = 200.0f;  // –º–∞–∫—Å. –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π —Å—Ç—Ä–∏–±–æ–∫, –º
static const float GNSS_MAX_SPEED_JUMP  = 150.0f;  // –º–∞–∫—Å. "–º–∏—Ç—Ç—î–≤–∏–π" —Ä–∏–≤–æ–∫ —à–≤–∏–¥–∫–æ—Å—Ç—ñ, –º/—Å
static const float GNSS_MAX_SPEED_MPS   = 120.0f;  // —Ñ—ñ–∑–∏—á–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å UAV, –º/—Å
static const float GNSS_MAX_ALT_JUMP_M  = 100.0f;  // –º–∞–∫—Å. —Å—Ç—Ä–∏–±–æ–∫ –ø–æ –≤–∏—Å–æ—Ç—ñ, –º
~~~

| –ü–∞—Ä–∞–º–µ—Ç—Ä                | –¢–∏–ø    | –î–µ—Ñ–æ–ª—Ç | –û–ø–∏—Å                                                            |
|-------------------------|--------|--------|-----------------------------------------------------------------|
| `GNSS_MAX_DIST_JUMP_M`  | `float`| `200`  | –Ø–∫—â–æ –¥–∏—Å—Ç–∞–Ω—Ü—ñ—è –º—ñ–∂ –¥–≤–æ–º–∞ –≤–∏–º—ñ—Ä–∞–º–∏ > —Ü—å–æ–≥–æ ‚Äî –ø—ñ–¥–æ–∑—Ä–∞ –Ω–∞ —Å–ø—É—Ñ—ñ–Ω–≥ |
| `GNSS_MAX_SPEED_JUMP`   | `float`| `150`  | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π ‚Äú—Ä–∏–≤–æ–∫‚Äù —à–≤–∏–¥–∫–æ—Å—Ç—ñ –º—ñ–∂ –¥–≤–æ–º–∞ –≤–∏–º—ñ—Ä–∞–º–∏               |
| `GNSS_MAX_SPEED_MPS`    | `float`| `120`  | –§—ñ–∑–∏—á–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å UAV                               |
| `GNSS_MAX_ALT_JUMP_M`   | `float`| `100`  | –ú–∞–∫—Å. —Å—Ç—Ä–∏–±–æ–∫ –ø–æ –≤–∏—Å–æ—Ç—ñ –º—ñ–∂ –≤–∏–º—ñ—Ä–∞–º–∏                            |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –î–ª—è –∫—Ä–∏–ª–∞ 25‚Äì40 –º/—Å –º–æ–∂–Ω–∞ —Å—Ç–∞–≤–∏—Ç–∏ `GNSS_MAX_SPEED_MPS ‚âà 80`.
- –î–ª—è high-speed (>100 –º/—Å) –∑–±—ñ–ª—å—à–∏—Ç–∏ `GNSS_MAX_SPEED_MPS` —Ç–∞, –º–æ–∂–ª–∏–≤–æ, `GNSS_MAX_DIST_JUMP_M`.

---

## 4.2. –ü–µ—Ä–µ–ª—ñ—Ç —É –ü—ñ–≤–¥–µ–Ω–Ω—É –ø—ñ–≤–∫—É–ª—é

–°–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞:

~~~cpp
bool jumped_to_southern_hemisphere =
    prev_fix_valid &&
    prev_lat > 0.0f &&
    lat      < 0.0f &&
    distance_m(prev_lat, prev_lon, lat, lon) > GNSS_MAX_DIST_JUMP_M;
~~~

–ü—Ä–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω–Ω—ñ:

- –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è DR-—Ä–µ–∂–∏–º;
- —É –ª–æ–≥–∏ —Ç–∞ `STATUSTEXT` –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É `SPOOF: SOUTH HEMI JUMP`.

> üîß –Ø–∫—â–æ —Ä–µ–∞–ª—å–Ω–æ –ø–ª–∞–Ω—É—î—Ç–µ –º—ñ—Å—ñ—ó –∑ –ø–µ—Ä–µ—Ç–∏–Ω–æ–º –µ–∫–≤–∞—Ç–æ—Ä–∞ ‚Äî —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç—Ä–µ–±–∞ –±—É–¥–µ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–º–∏–∫–∞—Ç–∏ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –º—ñ—Å—ñ—è—Ö).

---

# 5. Dead Reckoning (DR)

## 5.1. –¢–∞–π–º—ñ–Ω–≥–∏ –≤—Ö–æ–¥—É/–≤–∏—Ö–æ–¥—É

~~~cpp
static const uint32_t DR_ENTER_MIN_BAD_MS = 3000;   // –º—Å "–ø–æ–≥–∞–Ω–∏—Ö" –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º –≤ DR
static const uint32_t DR_EXIT_MIN_GOOD_MS = 10000;  // –º—Å "—Ö–æ—Ä–æ—à–∏—Ö" –¥–∞–Ω–∏—Ö –¥–ª—è –≤–∏—Ö–æ–¥—É –∑ DR
static const uint32_t GNSS_FIX_TIMEOUT_MS = 15000;  // —Ç–∞–π–º-–∞—É—Ç –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ fix
~~~

| –ü–∞—Ä–∞–º–µ—Ç—Ä               | –¢–∏–ø        | –î–µ—Ñ–æ–ª—Ç | –û–ø–∏—Å                                                |
|------------------------|------------|--------|-----------------------------------------------------|
| `DR_ENTER_MIN_BAD_MS`  | `uint32_t` | `3000` | –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —á–∞—Å (–º—Å) –∑ –ø–æ–≥–∞–Ω–∏–º GNSS –ø–µ—Ä–µ–¥ DR       |
| `DR_EXIT_MIN_GOOD_MS`  | `uint32_t` | `10000`| –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —á–∞—Å (–º—Å) –∑—ñ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–º GNSS –¥–ª—è –≤–∏—Ö–æ–¥—É |
| `GNSS_FIX_TIMEOUT_MS`  | `uint32_t` | `15000`| –Ø–∫—â–æ –Ω–µ–º–∞—î fix –¥–æ–≤—à–µ —Ü—å–æ–≥–æ ‚Äî –∞–≤–∞—Ä—ñ–π–Ω–∏–π DR          |

## 5.2. –°—Ç–∞–Ω–∏ DR

~~~cpp
enum DrMode : uint8_t {
    DR_MODE_OFF = 0,  // DR0
    DR_MODE_ON  = 1   // DR1
};

static DrMode dr_mode = DR_MODE_OFF;
~~~

–£ –ª–æ–≥–∞—Ö:

- `DR0` ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–µ–∂–∏–º.
- `DR1` ‚Äî DR –∞–∫—Ç–∏–≤–Ω–∏–π (GPS –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π/–∑–∞–º–æ—Ä–æ–∂–µ–Ω–∏–π/–∑–∞–º—ñ–Ω–µ–Ω–∏–π).

---

# 6. MAVLink-–ø–æ–≤–µ–¥—ñ–Ω–∫–∞

## 6.1. GPS-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (GPS_INPUT / HIL_GPS)

–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è `mavlink_gps_input_t`:

~~~cpp
mavlink_gps_input_t gps_in;

gps_in.time_usec       = micros64();
gps_in.gps_id          = 0;
gps_in.ignore_flags    = 0;            // –∞–±–æ –º–∞—Å–∫–∞ —Ç–æ–≥–æ, —â–æ —ñ–≥–Ω–æ—Ä—É—î–º–æ
gps_in.time_week_ms    = ubx_week_ms;
gps_in.time_week       = ubx_week;
gps_in.fix_type        = fix;         // 0..3
gps_in.lat             = lat * 1e7;
gps_in.lon             = lon * 1e7;
gps_in.alt             = alt;         // –º–µ—Ç—Ä–∏ –Ω–∞–¥ MSL
gps_in.vn              = vel_n;
gps_in.ve              = vel_e;
gps_in.vd              = vel_d;
gps_in.hdop            = hdop;
gps_in.vdop            = vdop;
gps_in.yaw             = heading_deg * 100.0f; // —è–∫—â–æ —î
gps_in.satellites_used = sats;
~~~

–ü–∞–∫–µ—Ç –ø–∞–∫—É—î—Ç—å—Å—è –π –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è:

~~~cpp
mavlink_message_t msg;
mavlink_msg_gps_input_pack(
    MY_SYSID,
    MY_COMPID,
    &msg,
    FC_SYSID,
    FC_COMPID,
    &gps_in
);
send_mavlink_to_fc(msg);
~~~

**–†–µ–∂–∏–º DR**

- –Ø–∫—â–æ `dr_mode == DR_MODE_ON`, —Ç–æ:
  - –∞–±–æ `gps_input` –Ω–µ —à–ª–µ—Ç—å—Å—è –≤–∑–∞–≥–∞–ª—ñ;
  - –∞–±–æ `lat/lon/alt` –±–µ—Ä—É—Ç—å—Å—è –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –≤–∞–ª—ñ–¥–Ω–æ–≥–æ fix (`last_good_lat` —ñ —Ç.–¥.).

---

## 6.2. STATUSTEXT

~~~cpp
static void send_status_text(uint8_t severity, const char *fmt, ...) {
    char buf[80];
    va_list ap;
    va_start(ap, fmt);
    vsnprintf(buf, sizeof(buf), fmt, ap);
    va_end(ap);

    mavlink_message_t msg;
    mavlink_msg_statustext_pack(
        MY_SYSID,
        MY_COMPID,
        &msg,
        severity,
        buf,
        0 // id
    );
    send_mavlink_to_fc(msg);
}
~~~

–¢–∏–ø–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:

- `GPS: ENTER DR (jump)` ‚Äî –≤—Ö—ñ–¥ –≤ DR —á–µ—Ä–µ–∑ —Å—Ç—Ä–∏–±–æ–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.
- `GPS: ENTER DR (no fix)` ‚Äî –≤—Ö—ñ–¥ –≤ DR —á–µ—Ä–µ–∑ —Ç–∞–π–º-–∞—É—Ç fix.
- `GPS: EXIT DR` ‚Äî –≤–∏—Ö—ñ–¥ —ñ–∑ DR –ø—ñ—Å–ª—è —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—ó GNSS.

**Severity**

- `MAV_SEVERITY_WARNING` (`4`) ‚Äî –¥–ª—è –≤—Ö–æ–¥—É –≤ DR.
- `MAV_SEVERITY_ERROR` (`3`) ‚Äî –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –∫–µ–π—Å—ñ–≤ (—Ç–µ–ª–µ–ø–æ—Ä—Ç –≤ –ü—ñ–≤–¥–µ–Ω–Ω—É –ø—ñ–≤–∫—É–ª—é).
- `MAV_SEVERITY_INFO` (`6`) ‚Äî –¥–ª—è `EXIT DR` —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∏—Ö –ª–æ–≥—ñ–≤.

---

# 7. EEPROM / –∫–æ–Ω—Ñ—ñ–≥ (–æ–ø—Ü—ñ–π–Ω–æ)

–Ø–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤–∏–Ω–æ—Å—è—Ç—å—Å—è –≤ EEPROM, –º–æ–∂–µ –±—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

~~~cpp
struct Config {
    float   max_dist_jump_m;
    float   max_speed_mps;
    float   max_hdop_good;
    uint8_t min_sats_fix;
    uint8_t min_sats_good;
};

#define EEPROM_ADDR_CFG  0
Config cfg;
~~~

–ú–∞–ø–∞:

| –ê–¥—Ä–µ—Å–∞ | –ü–æ–ª–µ              | –¢–∏–ø      |
|--------|-------------------|----------|
| `0`    | `max_dist_jump_m` | `float`  |
| `4`    | `max_speed_mps`   | `float`  |
| `8`    | `max_hdop_good`   | `float`  |
| `12`   | `min_sats_fix`    | `uint8_t`|
| `13`   | `min_sats_good`   | `uint8_t`|

–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:

~~~cpp
EEPROM.get(EEPROM_ADDR_CFG, cfg);
~~~

–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è:

~~~cpp
EEPROM.put(EEPROM_ADDR_CFG, cfg);
~~~


---

# 8. –§–æ—Ä–º–∞—Ç –ª–æ–≥—ñ–≤ –ø–æ USB

–¢–∏–ø–æ–≤–∏–π —Ä—è–¥–æ–∫:

~~~text
fix=3 s=18 hd=0.9 sp=0.0 crs=0.0 alt=176.3 DR0
~~~

–ü–æ–ª—è:

- `fix` ‚Äî —Ç–∏–ø fix (0‚Äì3).
- `s` ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—É–ø—É—Ç–Ω–∏–∫—ñ–≤.
- `hd` ‚Äî HDOP.
- `sp` ‚Äî ground speed (–º/—Å).
- `crs` ‚Äî ground course (–≥—Ä–∞–¥—É—Å–∏).
- `alt` ‚Äî –≤–∏—Å–æ—Ç–∞.
- `DR0` / `DR1` ‚Äî –ø–æ—Ç–æ—á–Ω–∏–π —Ä–µ–∂–∏–º Dead Reckoning.

---

# 9. –©–æ –º–∞—î —Å–µ–Ω—Å –ø—ñ–¥–∫—Ä—É—á—É–≤–∞—Ç–∏ –ø—ñ–¥ –º—ñ—Å—ñ—é

1. **–ü—Ä–æ—Ñ—ñ–ª—å —à–≤–∏–¥–∫–æ—Å—Ç—ñ**
   - `GNSS_MAX_SPEED_MPS`
   - `GNSS_MAX_DIST_JUMP_M`
   - `GNSS_MAX_ALT_JUMP_M`

2. **–Ø–∫—ñ—Å—Ç—å GNSS —É —Ä–µ–≥—ñ–æ–Ω—ñ**
   - `GNSS_MIN_SATS_FIX`
   - `GNSS_MIN_SATS_GOOD`
   - `GNSS_MAX_HDOP_GOOD`

3. **–ß—É—Ç–ª–∏–≤—ñ—Å—Ç—å –¥–æ —Å–ø—É—Ñ—ñ–Ω–≥—É / –ø—Ä–æ–ø–∞–¥–∞–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—É**
   - `DR_ENTER_MIN_BAD_MS`
   - `DR_EXIT_MIN_GOOD_MS`
   - `GNSS_FIX_TIMEOUT_MS`

4. **MAVLink IDs**
   - `MY_SYSID`, `MY_COMPID`
   - `FC_SYSID`, `FC_COMPID` (—è–∫—â–æ –∑–º—ñ–Ω—é–≤–∞–≤ `SYSID_THISMAV` –≤ ArduPilot)

---
